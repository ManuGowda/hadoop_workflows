Keeping performance in mind i have came up with two solutions
1) parameterized the time interval it has to run for and limiting the records by parameter n
2) To aggregate the complete result set without limiting anything
